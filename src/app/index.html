<!DOCTYPE html>
<html>
    <head>
        <link href="style.css" rel="stylesheet" />
        <title>UBC Course Dependency Navigator</title>
    </head>
    <body>
        <h1>Course Search</h1>
        <p>getting the api to work</p>
        <!-- TODO: include input validation -->
        <input type="text" id="courseInput" placeholder="Enter a Course">
        <button type="submit" onclick="searchCourse()">Submit</button>
        <p>if you want to see all UBC courses:</p>
        <!-- button to get all courses -->
        <button type="button" onclick="getAllCourses()"> Get All Course Codes </button>

        <ul id="courseList">

        </ul>

        <!-- TODO: eventually migrate all api-related function to course-api.js
            <script src="scripts/course-api.js"></script> -->
        <script>
            function getAllCourses(){
                fetch('https://ubcexplorer.io/getAllCourses')
                .then(res => {
                    return res.json();
                })
                .then(data => {
                    console.log(data);
                    const start = performance.now();
                    data.forEach(course => {
                        document.getElementById("courseList").innerHTML += "<li>" + course.code + "</li>" + "<ul>" + "<li>credits:" + course.cred + "</li>" + "</ul>";
                        console.log("done");
                    });
                    console.log('Script executed in ' + elapsed + 'time');
                })
            }

            // get array containing: course Subject and Code 
            function getCourseSubjectAndCode(){
                const course = document.getElementById('courseInput');
                const courseArray = course.value.toUpperCase().split(" ");
                return courseArray;
            }

            function searchCourse(){
                courseArray = getCourseSubjectAndCode();
                fetch('https://ubcexplorer.io/getCourseInfo/' + courseArray[0] + '%20' +courseArray[1])
                .then(res => {
                    return res.json();
                })
                .then(cData => {
                    console.log(cData);
                    document.getElementById("courseList").innerHTML +=
                        "<li>" + cData.code + "</li>" +
                        "<ul>" + "<li>Course name: " + cData.name + "</li>" + "</ul>" +
                        "<ul>" + "<li>Credits: " + cData.cred + "</li>" + "</ul>" +
                        "<ul>" + "<li>Description: " + cData.desc + "</li>" + "</ul>" +
                        "<ul>" + "<li>Pre-requisites: " + cData.prer + "</li>" + "</ul>";
                        // "<ul>" + "<li>Depedents: " + cData.dep + "</li>" + "</ul>";
                })
            }
        </script>

    </body>
 </html>